{
  "moduleId": 13,
  "lessonNumber": 5,
  "lessonId": "M13L05",
  "title": "Event Handling (@onclick, @onchange)",
  "simplifierConcept": "Events are like doorbells:\n\nUser clicks button = Someone rings doorbell\nYour C# method runs = You answer the door\n\nBlazor events:\n‚Ä¢ @onclick - Button clicks, div clicks\n‚Ä¢ @onchange - Input value changes\n‚Ä¢ @oninput - Every keystroke\n‚Ä¢ @onsubmit - Form submission\n‚Ä¢ @onmouseover - Mouse hover\n\nEvent handling:\n1. User interacts (click, type, hover)\n2. Browser fires event\n3. Blazor calls your C# method\n4. Method updates state\n5. UI re-renders automatically!\n\nThink: Events = 'User does something ‚Üí Your C# code responds!'",
  "coderExample": "// CLICK EVENTS\n<button @onclick=\"HandleClick\">Click Me</button>\n<button @onclick=\"() => count++\">Increment</button>\n<button @onclick=\"@(() => DoWork(5))\">Pass Parameter</button>\n\n@code {\n    private void HandleClick() {\n        Console.WriteLine(\"Button clicked!\");\n    }\n    \n    private void DoWork(int value) {\n        Console.WriteLine($\"Working with {value}\");\n    }\n}\n\n// CHANGE EVENTS\n<input @onchange=\"HandleNameChange\" />\n<select @onchange=\"HandleCategoryChange\">\n    <option>Category 1</option>\n</select>\n\n@code {\n    private void HandleNameChange(ChangeEventArgs e) {\n        string newValue = e.Value.ToString();\n        Console.WriteLine($\"Name changed to: {newValue}\");\n    }\n}\n\n// INPUT EVENTS (every keystroke)\n<input @oninput=\"HandleInput\" />\n<p>You typed: @currentInput</p>\n\n@code {\n    private string currentInput = \"\";\n    \n    private void HandleInput(ChangeEventArgs e) {\n        currentInput = e.Value.ToString();\n    }\n}\n\n// KEYBOARD EVENTS\n<input @onkeydown=\"HandleKeyDown\" @onkeyup=\"HandleKeyUp\" />\n\n@code {\n    private void HandleKeyDown(KeyboardEventArgs e) {\n        if (e.Key == \"Enter\") {\n            Console.WriteLine(\"Enter pressed!\");\n        }\n    }\n}\n\n// MOUSE EVENTS\n<div @onmouseover=\"() => isHovered = true\" \n     @onmouseout=\"() => isHovered = false\"\n     class=\"@(isHovered ? \\\"highlight\\\" : \\\"\\\")\">\ 
    Hover over me!\n</div>\n\n// FORM SUBMIT\n<EditForm Model=\"@person\" OnValidSubmit=\"HandleSubmit\">\n    <button type=\"submit\">Submit</button>\n</EditForm>\n\n@code {\n    private Person person = new();\n    \n    private void HandleSubmit() {\n        Console.WriteLine(\"Form submitted!\");\n    }\n}",
  "syntaxBreakdown": [
    {
      "codeSnippet": "@onclick=\"MethodName\"",
      "explanation": "Calls C# method on click. No parentheses if no parameters. For lambda: @onclick=\"() => code\". Event fires, method runs, UI updates."
    },
    {
      "codeSnippet": "ChangeEventArgs",
      "explanation": "Event argument object. Use e.Value for new value. Different types: KeyboardEventArgs, MouseEventArgs, FocusEventArgs, etc."
    },
    {
      "codeSnippet": "@oninput vs @onchange",
      "explanation": "@oninput fires on every keystroke. @onchange fires when input loses focus (blur). Use @oninput for live updates, @onchange for final value."
    },
    {
      "codeSnippet": "Event with parameters",
      "explanation": "Use lambda to pass parameters: @onclick=\"() => Delete(item.Id)\". Or: @onclick=\"@(() => Process(item))\". Lambda wraps method call."
    }
  ],
  "challenge": {
    "instructions": "Create an interactive task manager with events!\n\n1. TaskManager component:\n   - Input for task name (@oninput updates as you type)\n   - Button \"Add Task\" (@onclick)\n   - List of tasks\n   - Each task has:\n     - Checkbox (@onchange to mark complete)\n     - Delete button (@onclick)\n   - Show count of total and completed tasks\n\n2. Events to handle:\n   - Input change (live preview)\n   - Add task (button click)\n   - Toggle complete (checkbox change)\n   - Delete task (button click)\n\n3. Print component structure!",
    "starterCode": "// TaskManager.razor\n<div class=\"task-manager\">\n    <h3>Task Manager</h3>\n    \n    <div class=\"input-group\">\n        <input \n            @oninput=\"HandleTaskInput\" \n            @onkeydown=\"HandleKeyPress\"\n            placeholder=\"Enter task name\" />\n        <button @onclick=\"AddTask\">Add Task</button>\n    </div>\n    \n    <p>Preview: @currentTaskName</p>\n    \n    <ul>\n        @foreach (var task in tasks)\n        {\n            <li>\n                <input \n                    type=\"checkbox\" \n                    checked=\"@task.IsCompleted\"\n                    @onchange=\"() => ToggleTask(task.Id)\" />\n                <span class=\"@(task.IsCompleted ? \\\"completed\\\" : \\\"\\\")\">@task.Name</span>\n                <button @onclick=\"() => DeleteTask(task.Id)\">Delete</button>\n            </li>\n        }\n    </ul>\n    \n    <p>Total: @tasks.Count | Completed: @tasks.Count(t => t.IsCompleted)</p>\n</div>\n\n@code {\n    // Implement task management\n}",
    "solutionCode": "Console.WriteLine(@\"\n// TaskManager.razor\nusing System;\nusing System.Collections.Generic;\nusing System.Linq;\n\n<div class=\"\"task-manager\"\">\n    <h3>üìù Task Manager</h3>\n    \n    <div class=\"\"input-group mb-3\"\">\n        <input \n            class=\"\"form-control\"\"\n            @bind=\"\"currentTaskName\"\"\n            @onkeydown=\"\"HandleKeyPress\"\"\n            placeholder=\"\"Enter task name\"\" />\n        <button class=\"\"btn btn-primary\"\" @onclick=\"\"AddTask\"\">Add Task</button>\n    </div>\n    \n    <div class=\"\"alert alert-info\"\">\n        Preview: @(string.IsNullOrEmpty(currentTaskName) ? \"\"(empty)\"\" : currentTaskName)\n    </div>\n    \n    <ul class=\"\"list-group\"\">\n        @foreach (var task in tasks)\n        {\n            <li class=\"\"list-group-item\"\">\n                <input \n                    type=\"\"checkbox\"\" \n                    checked=\"\"@task.IsCompleted\"\"\n                    @onchange=\"\"() => ToggleTask(task.Id)\"\" />\n                <span class=\"\"@(task.IsCompleted ? \\\"\"text-decoration-line-through\\\"\" : \"\"\"\")\"\">\n                    @task.Name\n                </span>\n                <button \n                    class=\"\"btn btn-sm btn-danger float-end\"\" \n                    @onclick=\"\"() => DeleteTask(task.Id)\"\">Delete</button>\n            </li>\n        }\n    </ul>\n    \n    <div class=\"\"mt-3\"\">\n        <strong>Total: @tasks.Count</strong> | \n        <strong>Completed: @tasks.Count(t => t.IsCompleted)</strong> |\n        <strong>Remaining: @tasks.Count(t => !t.IsCompleted)</strong>\n    </div>\n</div>\n\n@code {\n    private class TaskItem {\n        public int Id { get; set; }\n        public string Name { get; set; } = \"\"\"\";\n        public bool IsCompleted { get; set; }\n    }\n    \n    private List<TaskItem> tasks = new();\n    private string currentTaskName = \"\"\"\";\n    private int nextId = 1;\n    \n    private void AddTask() {\n        if (!string.IsNullOrWhiteSpace(currentTaskName)) {\n            tasks.Add(new TaskItem { \n                Id = nextId++, \n                Name = currentTaskName, \n                IsCompleted = false \n            });\n            currentTaskName = \"\"\"\";\n            Console.WriteLine($\"\"Task added! Total: {tasks.Count}\"\");\n        }\n    }\n    \n    private void HandleKeyPress(KeyboardEventArgs e) {\n        if (e.Key == \"\"Enter\"\") {\n            AddTask();\n        }\n    }\n    \n    private void ToggleTask(int taskId) {\n        var task = tasks.FirstOrDefault(t => t.Id == taskId);\n        if (task != null) {\n            task.IsCompleted = !task.IsCompleted;\n            Console.WriteLine($\"\"{task.Name}: {(task.IsCompleted ? \\\"\"Completed\\\"\" : \\\"\"Incomplete\\\"\")}\"\");\n        }\n    }\n    \n    private void DeleteTask(int taskId) {\n        var task = tasks.FirstOrDefault(t => t.Id == taskId);\n        if (task != null) {\n            tasks.Remove(task);\n            Console.WriteLine($\"\"Deleted: {task.Name}\"\");\n        }\n    }\n}\n\"\");\n\nConsole.WriteLine(@\"\n=== EVENTS DEMONSTRATED ===\");\nConsole.WriteLine(\"‚úì @bind - Two-way binding for input\");\nConsole.WriteLine(\"‚úì @onkeydown - Enter key to add task\");\nConsole.WriteLine(\"‚úì @onclick - Add and Delete buttons\");\nConsole.WriteLine(\"‚úì @onchange - Checkbox toggle\");\nConsole.WriteLine(\"‚úì Lambda with parameters: () => DeleteTask(id)\");\nConsole.WriteLine(\"\\n‚úì All events ‚Üí C# methods ‚Üí UI updates!\");",
    "hint": "@onclick for buttons. @onchange for checkbox. @bind for two-way input binding. @onkeydown to detect Enter key. Use lambdas to pass parameters: () => Method(id).",
    "expectedOutputPatterns": ["TaskManager", "@onclick", "@onchange", "@bind", "ToggleTask", "DeleteTask"],
    "validationRules": [],
    "commonStickingPoints": [
      "Event propagation: @onclick on parent and child? Both fire! Use @onclick:stopPropagation to prevent bubbling. Or handle in only one place.",
      "Async event handlers: Can use async methods! '@onclick=\"HandleClickAsync\"' with 'private async Task HandleClickAsync()'. Blazor awaits automatically.",
      "Event args: Different events have different args! ChangeEventArgs for input/select, MouseEventArgs for mouse, KeyboardEventArgs for keyboard. Check e.Key, e.Button, etc.",
      "Lambda scope: Variables in lambda must be in scope! '@onclick=\"() => Delete(item.Id)\"' in foreach works. Outside foreach, 'item' not available!"
    ]
  }
}
