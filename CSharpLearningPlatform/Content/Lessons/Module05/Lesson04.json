{
  "moduleId": 5,
  "lessonNumber": 4,
  "lessonId": "M05L04",
  "title": "Working with Collections (Common Operations)",
  "simplifierConcept": "Now you know Arrays, Lists, and Dictionaries!\nTime to learn COMMON OPERATIONS that work on all of them:\n\n\ud83d\udd0d FINDING:\n- Does it contain X?\n- Where is X located?\n- Give me all items matching condition\n\n\ud83d\udcca AGGREGATING:\n- Sum, Average, Min, Max\n- Count items matching condition\n\n\ud83d\udd04 TRANSFORMING:\n- Sort, Reverse, Filter\n- Convert between types\n\n\u2702\ufe0f SPLITTING/JOINING:\n- Split string into array\n- Join array into string\n\nThink: Collections are like toolboxes - learn the tools that work on all of them!",
  "coderExample": "using System;\nusing System.Collections.Generic;\nusing System.Linq;  // IMPORTANT for advanced operations!\n\n// SORTING\nint[] numbers = { 5, 2, 8, 1, 9 };\nArray.Sort(numbers);  // Ascending: 1, 2, 5, 8, 9\nArray.Reverse(numbers);  // Descending: 9, 8, 5, 2, 1\n\nList<string> names = new List<string> { \"Charlie\", \"Alice\", \"Bob\" };\nnames.Sort();  // Alphabetical: Alice, Bob, Charlie\nnames.Reverse();  // Reverse: Charlie, Bob, Alice\n\n// MIN / MAX / SUM (with LINQ)\nint[] scores = { 85, 92, 78, 95, 88 };\nint highest = scores.Max();  // 95\nint lowest = scores.Min();  // 78\nint total = scores.Sum();  // 438\ndouble average = scores.Average();  // 87.6\n\nConsole.WriteLine($\"Highest: {highest}, Average: {average}\");\n\n// COUNT WITH CONDITION\nint countAbove90 = scores.Count(s => s >= 90);  // 2 (92 and 95)\nConsole.WriteLine($\"Scores >= 90: {countAbove90}\");\n\n// FILTERING (WHERE)\nint[] allNumbers = { 1, 2, 3, 4, 5, 6, 7, 8, 9, 10 };\nvar evenNumbers = allNumbers.Where(n => n % 2 == 0).ToArray();\n// evenNumbers: [2, 4, 6, 8, 10]\n\nList<string> fruits = new List<string> { \"Apple\", \"Banana\", \"Apricot\", \"Orange\" };\nvar startsWithA = fruits.Where(f => f.StartsWith(\"A\")).ToList();\n// startsWithA: [\"Apple\", \"Apricot\"]\n\n// FINDING FIRST MATCH\nint firstEven = allNumbers.First(n => n % 2 == 0);  // 2\nint firstAbove5 = allNumbers.FirstOrDefault(n => n > 5);  // 6\n// FirstOrDefault returns 0 if not found (safer!)\n\n// ANY / ALL\nbool hasEvens = allNumbers.Any(n => n % 2 == 0);  // true\nbool allPositive = allNumbers.All(n => n > 0);  // true\nbool allEven = allNumbers.All(n => n % 2 == 0);  // false\n\n// STRING OPERATIONS\nstring sentence = \"Hello World From C#\";\nstring[] words = sentence.Split(' ');  // [\"Hello\", \"World\", \"From\", \"C#\"]\nstring joined = string.Join(\"-\", words);  // \"Hello-World-From-C#\"\nstring comma = string.Join(\", \", words);  // \"Hello, World, From, C#\"\n\n// ARRAY TO LIST / LIST TO ARRAY\nint[] array = { 1, 2, 3, 4, 5 };\nList<int> list = array.ToList();  // Convert to List\nint[] backToArray = list.ToArray();  // Convert to Array\n\n// DISTINCT (Remove duplicates)\nint[] withDuplicates = { 1, 2, 2, 3, 3, 3, 4, 5, 5 };\nvar unique = withDuplicates.Distinct().ToArray();\n// unique: [1, 2, 3, 4, 5]\n\n// SELECT (Transform each item)\nint[] nums = { 1, 2, 3, 4, 5 };\nvar doubled = nums.Select(n => n * 2).ToArray();\n// doubled: [2, 4, 6, 8, 10]\n\nstring[] names2 = { \"alice\", \"bob\", \"charlie\" };\nvar upperNames = names2.Select(n => n.ToUpper()).ToArray();\n// upperNames: [\"ALICE\", \"BOB\", \"CHARLIE\"]\n\n// PRACTICAL: Student filtering\nList<int> grades = new List<int> { 95, 67, 82, 91, 55, 78, 88, 45, 92 };\n\nvar passed = grades.Where(g => g >= 60).ToList();\nvar failed = grades.Where(g => g < 60).ToList();\nvar honors = grades.Where(g => g >= 90).ToList();\n\nConsole.WriteLine($\"Passed: {passed.Count}\");\nConsole.WriteLine($\"Failed: {failed.Count}\");\nConsole.WriteLine($\"Honors: {honors.Count}\");\nConsole.WriteLine($\"Class average: {grades.Average():F2}\");\n\n// PRACTICAL: Shopping cart\nList<string> cart = new List<string> { \"Apple\", \"Banana\", \"Apple\", \"Orange\", \"Banana\", \"Apple\" };\n\nvar uniqueItems = cart.Distinct().ToList();\nConsole.WriteLine($\"Unique items: {string.Join(\", \", uniqueItems)}\");\n\nforeach (var item in uniqueItems)\n{\n    int count = cart.Count(i => i == item);\n    Console.WriteLine($\"{item}: {count}\");\n}\n\n// PRACTICAL: Data analysis\nint[] data = { 12, 45, 23, 67, 34, 89, 56, 78, 90, 34, 23, 67 };\n\nConsole.WriteLine(\"Statistics:\");\nConsole.WriteLine($\"Count: {data.Length}\");\nConsole.WriteLine($\"Sum: {data.Sum()}\");\nConsole.WriteLine($\"Average: {data.Average():F2}\");\nConsole.WriteLine($\"Min: {data.Min()}\");\nConsole.WriteLine($\"Max: {data.Max()}\");\nConsole.WriteLine($\"Unique values: {data.Distinct().Count()}\");\n\nvar sorted = data.OrderBy(x => x).ToArray();\nConsole.WriteLine($\"Sorted: {string.Join(\", \", sorted)}\");",
  "syntaxBreakdown": [
    {
      "codeSnippet": "using System.Linq;",
      "explanation": "Required for advanced collection methods! .Where(), .Select(), .Sum(), .Average(), .Any(), .All() etc. need this namespace. Add at top of file."
    },
    {
      "codeSnippet": ".Where(condition)",
      "explanation": "Filters collection. Returns items matching condition. nums.Where(n => n > 5) returns numbers greater than 5. => is lambda (covered next module)."
    },
    {
      "codeSnippet": ".Select(transform)",
      "explanation": "Transforms each item. nums.Select(n => n * 2) doubles each number. names.Select(n => n.ToUpper()) uppercases each name. Returns new collection."
    },
    {
      "codeSnippet": ".ToList() / .ToArray()",
      "explanation": "Converts result to List or Array. LINQ methods return IEnumerable - need .ToList() or .ToArray() to get usable collection."
    }
  ],
  "challenge": {
    "instructions": "Create a data analysis tool!\n\n1. Create List<int> with test scores:\n   [78, 92, 85, 67, 95, 88, 72, 90, 65, 82, 91, 77, 88, 94, 70]\n2. Analyze the data:\n   - Count total scores\n   - Calculate average, min, max\n   - Count how many passed (>= 70)\n   - Count how many failed (< 70)\n   - Count A grades (>= 90)\n   - Find all scores above average\n   - Remove duplicate scores\n   - Sort scores ascending and descending\n3. Display formatted report:\n   === GRADE ANALYSIS ===\n   Total scores: X\n   Average: X.X\n   Highest: X\n   Lowest: X\n   Passed: X (X%)\n   Failed: X (X%)\n   A grades: X\n   Above average: X scores\n   Unique scores: X\n   Sorted (asc): ...\n   Sorted (desc): ...",
    "starterCode": "// Data Analysis Tool\n\nusing System;\nusing System.Collections.Generic;\nusing System.Linq;\n\nList<int> scores = new List<int> { 78, 92, 85, 67, 95, 88, 72, 90, 65, 82, 91, 77, 88, 94, 70 };\n\n// Calculate statistics\n\n// Display report",
    "solutionCode": "// Data Analysis Tool\n\nusing System;\nusing System.Collections.Generic;\nusing System.Linq;\n\nList<int> scores = new List<int> { 78, 92, 85, 67, 95, 88, 72, 90, 65, 82, 91, 77, 88, 94, 70 };\n\n// Calculate statistics\nint total = scores.Count;\ndouble average = scores.Average();\nint min = scores.Min();\nint max = scores.Max();\n\nint passed = scores.Count(s => s >= 70);\nint failed = scores.Count(s => s < 70);\nint aGrades = scores.Count(s => s >= 90);\n\nvar aboveAverage = scores.Where(s => s > average).ToList();\nvar uniqueScores = scores.Distinct().ToList();\n\nvar sortedAsc = scores.OrderBy(s => s).ToList();\nvar sortedDesc = scores.OrderByDescending(s => s).ToList();\n\n// Display report\nConsole.WriteLine(\"=== GRADE ANALYSIS ===\");\nConsole.WriteLine($\"Total scores: {total}\");\nConsole.WriteLine($\"Average: {average:F2}\");\nConsole.WriteLine($\"Highest: {max}\");\nConsole.WriteLine($\"Lowest: {min}\");\nConsole.WriteLine();\n\ndouble passPercent = (double)passed / total * 100;\ndouble failPercent = (double)failed / total * 100;\nConsole.WriteLine($\"Passed (>= 70): {passed} ({passPercent:F1}%)\");\nConsole.WriteLine($\"Failed (< 70): {failed} ({failPercent:F1}%)\");\nConsole.WriteLine($\"A grades (>= 90): {aGrades}\");\nConsole.WriteLine();\n\nConsole.WriteLine($\"Above average ({average:F2}): {aboveAverage.Count} scores\");\nConsole.WriteLine($\"Scores: {string.Join(\", \", aboveAverage)}\");\nConsole.WriteLine();\n\nConsole.WriteLine($\"Unique scores: {uniqueScores.Count}\");\nConsole.WriteLine($\"Values: {string.Join(\", \", uniqueScores.OrderBy(x => x))}\");\nConsole.WriteLine();\n\nConsole.WriteLine($\"Sorted ascending:\");\nConsole.WriteLine(string.Join(\", \", sortedAsc));\nConsole.WriteLine();\n\nConsole.WriteLine($\"Sorted descending:\");\nConsole.WriteLine(string.Join(\", \", sortedDesc));",
    "hint": "Use .Count, .Average(), .Min(), .Max() for stats. .Count(s => condition) for filtered count. .Where(s => condition) for filtering. .Distinct() removes duplicates. .OrderBy() sorts ascending, .OrderByDescending() for descending. string.Join() to display.",
    "expectedOutputPatterns": [
      "ANALYSIS",
      "Average",
      "Passed",
      "Failed",
      "Sorted"
    ],
    "validationRules": [],
    "commonStickingPoints": [
      "Forgetting using System.Linq: Methods like .Where(), .Select(), .Sum() need this! Without it, these methods don't exist. Add using System.Linq; at top.",
      "Not converting to concrete type: var result = nums.Where(n => n > 5); gives IEnumerable. Can't access like array! Use .ToList() or .ToArray(): var result = nums.Where(n => n > 5).ToList();",
      "Lambda syntax confusion: n => n * 2 means 'for each n, return n * 2'. => is lambda operator. Left side is parameter, right side is expression. Like tiny function!",
      "Modifying during iteration: Can't modify collection during foreach! foreach (var x in list) { list.Remove(x); } ERROR! Use for loop backwards or create new list."
    ]
  }
}